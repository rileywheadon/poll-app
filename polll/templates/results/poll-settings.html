{% macro settings_item(attribute, state, text) %}

  <label 
    class="p-2 hover:bg-neutral-700 flex flex-row space-x-1"
    hx-trigger="click"
    hx-target="#poll-dropdown-{{ poll.id }}"
    hx-get="/poll/toggle/{{ attribute }}/{{ poll.id }}/{{ state }}"
    hx-swap="innerHTML"
  >
    <div class="w-8 flex flex-row justify-center items-center">
      {% if state %}
        <i class="text-polll-green fa fa-square-check"></i>
      {% else %}
        <i class="text-white fa fa-square-xmark"></i>
      {% endif %}
    </div>
    <span>{{ text }}</span>
  </label>

{% endmacro %}

<div class="flex flex-col">

  {{ settings_item("is_anonymous", poll.is_anonymous, "Hide my username") }}
  {{ settings_item("is_active", poll.is_active, "Allow responses") }}

  {% if session.user.is_admin %}
    {{ settings_item("is_pinned", poll.is_pinned, "Pin poll") }}
    {{ settings_item("is_editable", poll.is_editable, "Editable responses") }}
  {% endif %}

  <label 
    class="p-2 group hover:bg-neutral-700 flex flex-row space-x-1"
    hx-trigger="click"
    hx-get="/poll/delete/{{ poll.id }}"
    hx-target="closest .poll-card"
    hx-confirm="Are you sure you want to delete this poll?"
    hx-swap="delete"
  >
    <div class="w-8 flex flex-row justify-center items-center">
      <i class="fa fa-trash group-hover:text-polll-red"></i>
    </div>
    <span>Delete poll</span>
  </label>

</div>

<!-- hx-swap-oob makes me horny -->
<p 
  hx-swap-oob="true"
  id="poll-creator-{{ poll.id }}"
  class="font-light text-neutral-500 dark:text-neutral-400"
>
  {% if poll.is_anonymous == 1 %}
    anonymous
  {% else %}
    @{{ poll.creator }}
  {% endif %} â‹… {{ poll.age }}
</p>

