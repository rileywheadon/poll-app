{% extends "results/result-base.html" %}

{% block result_content %}

  <!-- {% for result in poll.results %}
    <p>
    ANSWER: {{ result.answer }} - 
    S: {{result.S}}
    A: {{result.A}}
    B: {{result.B}}
    C: {{result.C}}
    D: {{result.D}}
    F: {{result.F}}
    </p>
  {% endfor %} -->


  {% if poll.votes == 0 %}

    <p>No Votes Yet</p>
    
  {% else %}


  <!-- TODO: plot responses with a loop (zip=zip) -->

  <p class="mt-2">
    You responded: 
    {% for r in poll.response %}
    ({{ r.answer }}: {{r.tier}})
  </p>
  {% endfor %}
  <!-- {% for user_rs, avg_rs in iterable1|zip(iterable2) %}
    {{ value1 }} is paired with {{ value2 }}
  {% endfor %} -->

  <!-- {{ poll.response }}
  <br>
  {{ poll.results }} -->
  
  <div class="flex flex-row space-x-10 select-none">


    <!-- User response -->
    <div id="tier-list" class="w-[36rem] mt-4 border-2 dark:border-nord-4 rounded-xl {% if not poll.response %} hidden {% endif %}">
      {% for tier in ["S", "A", "B", "C", "D", "F"] %}

        <div class="flex flex-row h-16">
          <div class="w-16 border-r-2 {% if not tier == 'F' %} border-b-2 {% endif %} border-nord-0 dark:border-nord-4 mt-[-1px] ml-[-1px] flex items-center justify-center">
            <span class="text-2xl
            {% if   tier == 'S' %} text-tier-S
            {% elif tier == 'A' %} text-tier-A
            {% elif tier == 'B' %} text-tier-B
            {% elif tier == 'C' %} text-tier-C
            {% elif tier == 'D' %} text-tier-D
            {% elif tier == 'F' %} text-tier-F
            {% endif %}
            ">{{ tier }}</span>
          </div>
          <div class="{% if not tier == 'F' %} border-b-2 {% endif %} border-nord-0 dark:border-nord-4 mt-[-1px] ml-[-1px] grow flex flex-row justify-start tier-{{ tier }}">


            <!-- gets the index of the outer loop so it can be used in the inner loop -->
            {% set score = loop %}

            {% for r in poll.response %}
              <!-- score.index is a speical 1 based in jinja (zero based is score.index0) -->
              {% if r.score == score.index %} 
                <div class="border bg-nord-6 border-nord-2 dark:bg-nord-2 dark:border-nord-6 rounded-xl h-full w-32 flex items-center justify-center">
                  {{ r.answer }}
                </div>  
              {% endif %}
            {% endfor %}

          </div>
        </div>

      {% endfor %}
    </div>


    <!-- Average response -->
    <div id="tier-list" class="w-[36rem] mt-4 border-2 dark:border-nord-4 rounded-xl">
      {% for tier in ["S", "A", "B", "C", "D", "F"] %}

        <div class="flex flex-row h-16">
          <div class="w-16 border-r-2 {% if not tier == 'F' %} border-b-2 {% endif %} border-nord-0 dark:border-nord-4 mt-[-1px] ml-[-1px] flex items-center justify-center">
            <span class="text-2xl
            {% if   tier == 'S' %} text-tier-S
            {% elif tier == 'A' %} text-tier-A
            {% elif tier == 'B' %} text-tier-B
            {% elif tier == 'C' %} text-tier-C
            {% elif tier == 'D' %} text-tier-D
            {% elif tier == 'F' %} text-tier-F
            {% endif %}
            ">{{ tier }}</span>
          </div>
          <div class="{% if not tier == 'F' %} border-b-2 {% endif %} border-nord-0 dark:border-nord-4 mt-[-1px] ml-[-1px] grow flex flex-row justify-start tier-{{ tier }}">


            <!-- gets the index of the outer loop so it can be used in the inner loop -->
            {% set score = loop %}

            {% for r in poll.results %}
              <!-- score.index is a speical 1 based in jinja (zero based is score.index0) -->
              {% if r.score == score.index %} 
                <div class="border bg-nord-6 border-nord-2 dark:bg-nord-2 dark:border-nord-6 rounded-xl h-full w-32 flex items-center justify-center">
                  {{ r.answer }}
                </div>  
              {% endif %}
            {% endfor %}

          </div>
        </div>

      {% endfor %}
    </div>


  </div>


    <!-- {% if poll.response %}
      <p class="mt-2">
        You responded: 
        {% for r in poll.response %}
        ({{ r.answer }}: {{r.tier}})
      </p>
      {% endfor %}
      <script>graphInit("tier", {{ poll.id|safe }}, 5, {{ poll.results|safe }});</script>
      {% else %}
      <script>graphInit("tier", {{ poll.id|safe }}, 5, {{ poll.results|safe }});</script>
    {% endif %}
    <div id="poll-graph-{{ poll.id }}"></div> -->

  {% endif %}

{% endblock %}
