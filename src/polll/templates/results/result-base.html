<div 
  id="poll-card-{{ poll.id }}"
  class="poll-card py-2 border-b dark:border-neutral-700 overflow-hidden"
>    

  <!-- Include the poll question -->
  <div class="flex flex-row items-center p-2">

    <div class="flex flex-col p-2 select-none">
      <p class="font-light text-neutral-500">
        {% if poll.is_anonymous == 1 %}
          anonymous
        {% else %}
          @{{ poll.creator }}
        {% endif %} â‹… {{ poll.age }}
      </p>
      <p class=" font-light text-neutral-200 text-2xl">{{ poll.question }}</p>
    </div>

    <!-- If the user created this poll, allow them to edit it -->
    {% if session.user.id == poll.creator_id %} 

      <!-- Share Button -->
      <button 
        class="ml-auto text-xl w-10 ml-2 h-10 rounded-md py-1 hover:cursor-default"
        title="Share"
        onclick="copy_link('{{ poll.url }}')"
        type="button"
      >
        <i class="ml-1 fa fa-share-from-square hover:text-polll-green">
        </i>
      </button>

      <!-- Toggle Lock -->
      {% with %}
        {% set id=poll.id %}
        {% set is_active=poll.is_active %}
        {% include "results/poll-lock.html" %}
      {% endwith %}

      <!-- If the user is an administrator, allow them to pin this poll -->
      {% if session.user.is_admin %}

        {% with %}
          {% set id=poll.id %}
          {% set is_pinned=poll.is_pinned %}
          {% include "results/poll-pin.html" %}
        {% endwith %}

      {% endif %}
      
      <!-- Delete Poll -->
      <input class="hidden" name="poll_id" value="{{ poll.id }}">
      <button class="ml-2 text-xl w-10 h-10 rounded-md py-1 hover:cursor-default"
          title="Delete"
          hx-get="{{ url_for('poll.delete', poll_id = poll.id) }}"
          hx-include="previous input"
          hx-target="#poll-card-{{ poll.id }}"
          hx-swap="delete"
          hx-confirm="Are you sure you want to delete this poll?">
        <i class="fa fa-trash hover:text-polll-red"></i>
      </button>

    {% endif %}

  </div>



  <style>
    .fade-in {
      opacity: 1;
      animation-name: fadeInOpacity;
      animation-iteration-count: 1;
      animation-timing-function: ease-in;
      animation-duration: 1s;
    }
  
  
    @keyframes fadeInOpacity {
      0% {
          opacity: 0;
      }
      100% {
          opacity: 1;
      }
    }
  </style>

  <!-- Poll Graph -->
  <div id="poll-graph-{{ poll.id }}" class="md:px-8 md:py-4 fade-in">
    <!-- Separate Interfaces for Ranked Poll / Tier List -->
    {% if poll.poll_type == "RANKED_POLL" %}
      {% include "results/ranked-poll.html" %}
    {% elif poll.poll_type == "TIER_LIST" %}
      {% include "results/tier-list.html" %}
    {% endif %}

  </div>

  <div class="flex flex-row text-sm px-4 items-center my-4 select-none">
    <p class="font-light">
      Votes: {{ poll.response_count }}
    </p>

    <!-- Toggle Comments. Shows comment entry box and loads comments from database -->
    <button 
      class="ml-auto px-4 h-8 rounded-xl text-sm py-1 bg-neutral-300 hover:bg-white flex items-center justify-center select-none text-neutral-900"
      hx-on::after-request="toggle_comments({{ poll.id }})"
      hx-get="{{ url_for('poll.comments', poll_id = poll.id) }}"
      hx-target="#poll-comments-{{ poll.id }}"
      hx-swap="none"
    >
      <div class="whitespace-nowrap">
        <span id="comments-toggle-{{ poll.id }}">Show Comments</span> 
        <span id="comments-count-{{ poll.id }}">
          &nbsp({{ poll.comment_count }})
        </span>
      </div>
      <i class="fa fa-message pl-2 text-l"></i>
    </button>

    <!-- Show Results -->
    <button 
      class="ml-4 px-4 h-8 rounded-xl text-sm py-1 bg-polll-blue hover:bg-polll-green flex items-center justify-center select-none text-neutral-900"
      hx-get="{{ url_for('poll.result', poll_id = poll.id) }}"
      hx-target="#poll-graph-{{ poll.id }}"
      hx-swap="none"
    >
      <span id="graph-toggle-{{ poll.id }}" class="graph-toggle">Show Results</span>
      <i class="fa fa-chart-simple pl-2 text-xl"></i>
    </button>

  </div>

  <div class="poll-comments px-4 py-4 hidden" id="poll-comments-{{ poll.id }}">

    {% include "results/poll-comments.html" %}

  </div>

</div>
